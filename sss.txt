
CREATE TABLE nomina_trabajos_dia
(
  id_usuario bigint NOT NULL,
  fecha date NOT NULL DEFAULT now(),
  horas double precision NOT NULL DEFAULT 0,
  hrs_extra double precision NOT NULL DEFAULT 0,
  descripcion character varying(250),
  importe double precision NOT NULL DEFAULT 0,
  sueldo_diario double precision NOT NULL DEFAULT 0,
  id_empresa integer NOT NULL,
  importe_trabajo double precision NOT NULL DEFAULT 0,
  importe_extra double precision NOT NULL DEFAULT 0,
  tipo_asistencia character varying(8),
  CONSTRAINT nomina_trabajos_dia_pkey PRIMARY KEY (id_usuario, fecha, id_empresa),
  CONSTRAINT nomina_trabajos_dia_id_empresa_fkey FOREIGN KEY (id_empresa)
      REFERENCES empresas (id_empresa) MATCH SIMPLE
      ON UPDATE CASCADE ON DELETE CASCADE,
  CONSTRAINT nomina_trabajos_dia_id_usuario_fkey FOREIGN KEY (id_usuario)
      REFERENCES usuarios (id) MATCH SIMPLE
      ON UPDATE CASCADE ON DELETE CASCADE
)
WITH (
  OIDS=FALSE
);
ALTER TABLE nomina_trabajos_dia
  OWNER TO programa;

CREATE TABLE nomina_trabajos_dia_labores
(
  id_usuario bigint NOT NULL,
  fecha date NOT NULL DEFAULT now(),
  id_area bigint NOT NULL,
  id_labor integer NOT NULL,
  horas double precision NOT NULL DEFAULT 0,
  id_empresa integer NOT NULL,
  CONSTRAINT nomina_trabajos_dia_labores_pkey PRIMARY KEY (id_usuario, fecha, id_area, id_labor, id_empresa),
  CONSTRAINT nomina_trabajos_dia_labores_id_area_fkey FOREIGN KEY (id_area)
      REFERENCES compras_areas (id_area) MATCH SIMPLE
      ON UPDATE CASCADE ON DELETE CASCADE,
  CONSTRAINT nomina_trabajos_dia_labores_id_labor_fkey FOREIGN KEY (id_labor)
      REFERENCES compras_salidas_labores (id_labor) MATCH SIMPLE
      ON UPDATE CASCADE ON DELETE CASCADE,
  CONSTRAINT nomina_trabajos_dia_labores_id_usuario_fkey FOREIGN KEY (id_usuario, fecha, id_empresa)
      REFERENCES nomina_trabajos_dia (id_usuario, fecha, id_empresa) MATCH SIMPLE
      ON UPDATE CASCADE ON DELETE CASCADE
)
WITH (
  OIDS=FALSE
);
ALTER TABLE nomina_trabajos_dia_labores
  OWNER TO programa;

